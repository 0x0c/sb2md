var writer=function(d,g,f){d=void 0===d?"Title":d;g=void 0===g?[]:g;if(f)$.ajax({url:"http://127.0.0.1:"+window.PORT+"/create/pdf",method:"post",data:{texts:g,proxy:window.PROXY||""},dataType:"json"}).success(function(c){console.log(c)}).fail(function(c){console.log("request failed");writer(d,g,void 0)});else{f="";for(var c=0;c<g.length;c++)f+="\n"+g[c];c=window.open();c.document.open();c.document.write("<title>"+d+"</title>");c.document.write("<pre>");c.document.write(escapeHtml(f));c.document.write("</pre>");
c.document.close()}},escapeHtml=function(d){d=d.replace(/&/g,"&amp;");d=d.replace(/</g,"&lt;");d=d.replace(/>/g,"&gt;");d=d.replace(/"/g,"&quot;");return d=d.replace(/'/g,"&#39;")};
(function(){console.clear();for(var d="",g="",f=0,c=0,p=[],k=[""],h="",y=function(e){e=void 0===e?0:e;for(var a=h+"  ",b=1;b<e;b++)a+="  ";return a},v=function(e){e=void 0===e?0:e;0>e&&(e=0);var a=!1;for(2<=c-e&&(a=!0);a&&1<=c-e;){for(var b=h,d=1;d<Math.min(f,c);d++)b+="  ";k.push(b+"\\end{itemize}");--c}f=c;c=e;return[f,c]},w=function(){if(f!==c){for(var e=h,a=1;a<Math.max(f,c);a++)e+="  ";f<c&&k.push(e+"\\begin{itemize}");f>c&&k.push(e+"\\end{itemize}")}},z=function(e){e=void 0===e?1:e;return 1===
e?"\\subsubsection":2===e?(h="    ","\\subsection"):3===e?(h="  ","\\section"):""},A=function(e){e=void 0===e?"":e;var a=document.createElement("div");a.innerHTML=e;e=a.querySelectorAll("strong");for(var b=0;b<e.length;b++){var c=e[b],d=+c.className.split("level-")[1],h=c.innerHTML;c.innerHTML=z(d)+"{"+h+"}"}return a.innerHTML},B=function(a){for(var b=a.querySelectorAll(".formula"),c=0;c<b.length;c++){var d=b[c],h=d.querySelector("annotation");d.innerHTML=" $"+h.innerHTML+"$ "}return a},C=function(a){a=
void 0===a?"":a;var b=document.createElement("div");b.innerHTML=a;a=b.querySelectorAll("a");for(var c=0;c<a.length;c++){var d=a[c],f=d.innerText.trim(),g=d.href,k=f;"hashTag"===d.type&&(k="");f=d.querySelector("img");if(null!==f)if(f.classList.contains("icon"))k="";else{var g=g.split("/"),l=g[g.length-1].split("?"),g="[width=0.9\\linewidth]",m="";2===l.length&&(g="[width="+l[1]+"]");0<f.src.indexOf("gyazo.com/")&&(m=f.src.split("gyazo.com/")[1],m=m.split("/")[0].split(".")[0]);0<m.length&&(k=window.decodeURIComponent(l[0]),
k=[h+("%%IMAGE; "+m+"; "+f.src),h+"\\begin{figure}[h!]",h+"   \\begin{center}",h+("     \\includegraphics"+g+"{"+("./gyazos/"+m+".png")+"}"),h+("     \\caption{"+k+"}"),h+"   \\end{center}",h+"\\end{figure}"].join("\n"))}d.innerText=k}return b.innerText},r=function(){var a=p.join("");0<p.length&&0<a.trim().length&&(k.push(h+a),k.push(""),p=[])},q=document.querySelector(".lines"),q=q.querySelectorAll(".line"),t=!1,x=0,l=1;l<q.length;l++){var b=q[l].querySelector(".text").cloneNode(!0),a=b.querySelector('img.icon[src="/api/pages/icons/hr/icon"]');
if(t&&a)break;if(a)t=!0;else if(t){for(var n=b.querySelectorAll("span.empty-char-index"),a=0;a<n.length;a++){var u=n[a];u.innerText=""}n=b.querySelectorAll("span.backquote");for(a=0;a<n.length;a++)u=n[a],u.innerText=0===a%2?"{\\tt ":"}";b=B(b);a=b.innerHTML.replace(/<span>/g,"");a=a.replace(/<span.+?>/g,"").replace(/<\/span>/g,"");a=a.replace(/<br.+?>/g,"");a=a.replace(/\n/gi,"").replace(/\t/gi,"").trim();a=A(a);a=C(a);a=a.trim();0===d.length?(d=a,x=l):(b=b.querySelector(".indent-mark"),null!==b&&
(b=+b.style.width.split("em")[0]/1.5,a=y(b)+"\\item "+a,v(b)),l===x+1&&a.trim().startsWith("\\item")?(g=a.split("\\item ")[1].trim(),c=f=0):(b=a.trim(),b.startsWith("\\item")||v(0),b.startsWith("\\")?(r(),b.startsWith("\\section")||b.startsWith("\\subsection")||b.startsWith("\\subsubsection")?(b.startsWith("\\subsection")&&(a="  "+a),b.startsWith("\\subsubsection")&&(a="    "+a),0<k[k.length-1].length&&k.push("")):a=h+a,w(),k.push(a)):(w(),0<b.length&&!b.startsWith("%")?b.endsWith(".")||b.endsWith("\uff0e")||
b.endsWith("\u3002")||(b+=PERIOD):r(),p.push(b))))}}r();abstractBox=["\\begin{abstract}","  "+g,"\\end{abstract}"];head.push("\\title{"+d+"}");head.push("\\begin{document}");0<g.length&&head.push(abstractBox.join("\n"));head.push("  \\maketitle");k.forEach(function(a){head.push(a)});head.push("\\end{document}");writer(d,head,window.PORT)})();
