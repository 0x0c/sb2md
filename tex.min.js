var writer=function(d,f){d=void 0===d?"Title":d;f=void 0===f?[]:f;if(window.PORT)$.ajax({url:"http://127.0.0.1:"+window.PORT+"/create/pdf",method:"post",data:{texts:f,proxy:window.PROXY||""},dataType:"json"}).success(function(c){});else{for(var e="",c=0;c<f.length;c++)e+="\n"+f[c];c=window.open();c.document.open();c.document.write("<title>"+d+"</title>");c.document.write("<pre>");c.document.write(escapeHtml(e));c.document.write("</pre>");c.document.close()}},escapeHtml=function(d){d=d.replace(/&/g,
"&amp;");d=d.replace(/</g,"&lt;");d=d.replace(/>/g,"&gt;");d=d.replace(/"/g,"&quot;");return d=d.replace(/'/g,"&#39;")};
(function(){console.clear();for(var d="",f="\u6982\u8981",e=0,c=0,p=[],h=[""],g="",y=function(k){k=void 0===k?0:k;for(var a=g+"  ",b=1;b<k;b++)a+="  ";return a},v=function(k){k=void 0===k?0:k;0>k&&(k=0);var a=!1;for(2<=c-k&&(a=!0);a&&1<=c-k;){for(var b=g,d=1;d<Math.min(e,c);d++)b+="  ";h.push(b+"\\end{itemize}");--c}e=c;c=k;return[e,c]},w=function(){if(e!==c){console.log(e,c);for(var k=g,a=1;a<Math.max(e,c);a++)k+="  ";e<c&&h.push(k+"\\begin{itemize}");e>c&&h.push(k+"\\end{itemize}")}},z=function(a){a=
void 0===a?1:a;return 1===a?"\\subsubsection":2===a?(g="    ","\\subsection"):3===a?(g="  ","\\section"):""},A=function(a){a=void 0===a?"":a;var b=document.createElement("div");b.innerHTML=a;a=b.querySelectorAll("strong");for(var c=0;c<a.length;c++){var d=a[c],g=+d.className.split("level-")[1],e=d.innerHTML;d.innerHTML=z(g)+"{"+e+"}"}return b.innerHTML},B=function(a){for(var b=a.querySelectorAll(".formula"),c=0;c<b.length;c++){var d=b[c],g=d.querySelector("annotation");d.innerHTML=" $"+g.innerHTML+
"$ "}return a},C=function(a){a=void 0===a?"":a;var b=document.createElement("div");b.innerHTML=a;a=b.querySelectorAll("a");for(var c=0;c<a.length;c++){var d=a[c],e=d.innerText.trim(),f=d.href,h=e;"hashTag"===d.type&&(h="");e=d.querySelector("img");if(null!==e)if(e.classList.contains("icon"))h="";else{var f=f.split("/"),l=f[f.length-1].split("?"),f="[width=0.9\\linewidth]",m="";2===l.length&&(f="[width="+l[1]+"]");0<e.src.indexOf("gyazo.com/")&&(m=e.src.split("gyazo.com/")[1],m=m.split("/")[0].split(".")[0]);
0<m.length&&(h=window.decodeURIComponent(l[0]),h=[g+("%%IMAGE; "+m+"; "+e.src),g+"\\begin{figure}[H]",g+"   \\begin{center}",g+("     \\includegraphics"+f+"{"+("./gyazos/"+m+".png")+"}"),g+("     \\caption{"+h+"}"),g+"   \\end{center}",g+"\\end{figure}"].join("\n"))}d.innerText=h}return b.innerText},r=function(){var a=p.join("");0<p.length&&0<a.trim().length&&(h.push(g+a),h.push(""),p=[])},q=document.querySelector(".lines"),q=q.querySelectorAll(".line"),t=!1,x=0,l=1;l<q.length;l++){var b=q[l].querySelector(".text").cloneNode(!0),
a=b.querySelector('img.icon[src="/api/pages/icons/hr/icon"]');if(t&&a)break;if(a)t=!0;else if(t){for(var n=b.querySelectorAll("span.empty-char-index"),a=0;a<n.length;a++){var u=n[a];u.innerText=""}n=b.querySelectorAll("span.backquote");for(a=0;a<n.length;a++)u=n[a],u.innerText=0===a%2?"{\\tt ":"}";b=B(b);a=b.innerHTML.replace(/<span>/g,"");a=a.replace(/<span.+?>/g,"").replace(/<\/span>/g,"");a=a.replace(/<br.+?>/g,"");a=a.replace(/\n/gi,"").replace(/\t/gi,"").trim();a=A(a);a=C(a);a=a.trim();0===d.length?
(d=a,x=l):(b=b.querySelector(".indent-mark"),null!==b&&(b=+b.style.width.split("em")[0]/1.5,a=y(b)+"\\item "+a,v(b)),l===x+1&&a.trim().startsWith("\\item")?(f=a.split("\\item ")[1].trim(),c=e=0):(console.info(a),b=a.trim(),b.startsWith("\\item")||v(0),b.startsWith("\\")?(r(),b.startsWith("\\section")||b.startsWith("\\subsection")||b.startsWith("\\subsubsection")?(b.startsWith("\\subsection")&&(a="  "+a),b.startsWith("\\subsubsection")&&(a="    "+a),0<h[h.length-1].length&&h.push("")):a=g+a,w(),h.push(a)):
(w(),0<b.length&&!b.startsWith("%")?(console.warn(a),b.endsWith(".")||b.endsWith("\uff0e")||b.endsWith("\u3002")||(b+=PERIOD)):r(),p.push(b))))}}r();f=["\\begin{abstract}","  "+f,"\\end{abstract}"];head.push("\\title{"+d+"}");head.push("\\begin{document}");head.push("  \\maketitle");head.push(f.join("\n"));1<COLUMN&&head.push("\\begin{multicols}{"+COLUMN+"}");h.forEach(function(a){head.push(a)});1<COLUMN&&head.push("\\end{multicols}");head.push("\\end{document}");console.warn(head);writer(d,head)})();
